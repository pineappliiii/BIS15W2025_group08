---
title: "Game_Usage_Graphs"
output: html_document
---

```{r}
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(gtools)
library(DT)
library(readr)
library(shiny)
library(plotly)
```

```{r}
options(scipen=999)#cancels scientific notation for the session
```

```{r}
minecraft <- read_csv("copy_of_jiamins_minecraft_game_usage.csv")
```

```{r, eval=F, echo=T}
# Load required libraries
library(shiny)
library(shinydashboard)
library(ggplot2)
library(DT)
library(plotly)  # Load plotly for 3D plotting
library(readr)

# Read the data
minecraft <- read_csv("copy_of_jiamins_minecraft_game_usage.csv")

# Define UI
ui <- dashboardPage(
  dashboardHeader(title = "Minecraft"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Data Table", tabName = "data", icon = icon("table")),
      menuItem("Bar Graph", tabName = "graph", icon = icon("chart-column")),
      menuItem("Scatter Plot", tabName = "plot", icon = icon("chart-line")),
      menuItem("3D Plot", tabName = "three_D", icon = icon("cubes"))
    )
  ),
  dashboardBody(
    tabItems(
      # First tab: Data Table
      tabItem(
        tabName = "data",
        h2("Data Table"),
        DTOutput("data_table")
      ),
      
      # Second tab: Summary Statistics
      tabItem(
        tabName = "graph",
        h2("Bar Graph"),
        selectInput("x_var", "X-axis Variable", choices = c("Tools_Used", "Armor_Equipped", "Weather", "Game_Mode", "Day_Cycle", "Deaths", "Health_Remaining", "Hunger_Level", "Biome"), selected = "Deaths"),
        selectInput("y_var", "Fill Variable", choices = c("Tools_Used", "Armor_Equipped", "Weather", "Game_Mode", "Day_Cycle", "Deaths", "Health_Remaining", "Hunger_Level", "Biome"), selected = "Game_Mode"),
        plotOutput("bar_graph")
      ),
      
      # Third tab: Scatter Plot
      tabItem(
        tabName = "plot",
        h2("Scatter Plot"),
        selectInput("x_var", "X-axis Variable", choices = c("Playtime_minutes", "Blocks_Placed", "Blocks_Destroyed", "Items_Crafted", "Mobs_Killed", "Deaths", "Health_Remaining", "Hunger_Level", "Experience_Level", "Chat_Messages"), selected = "Blocks_Placed"),
        selectInput("y_var", "Y-axis Variable", choices = c("Playtime_minutes", "Blocks_Placed", "Blocks_Destroyed", "Items_Crafted", "Mobs_Killed", "Deaths", "Health_Remaining", "Hunger_Level", "Experience_Level", "Chat_Messages"), selected = "Blocks_Destroyed"),
        plotOutput("scatter_plot")
      ),
      
      # Fourth tab: 3D Plot
      tabItem(
        tabName = "three_D",
        h2("3D Plot"),
        selectInput("x", 
                    "Select Game Mode", 
                    choices = unique(minecraft$Game_Mode),
                    selected = "Survival"),
        plotlyOutput("three_D_plot")  # Use plotlyOutput here
      )
    )
  )
)

# Define Server
server <- function(input, output) {
  # Render Data Table
  output$data_table <- renderDT({
    minecraft %>% 
      select("Playtime_minutes", "Blocks_Placed", "Blocks_Destroyed", "Items_Crafted", "Mobs_Killed", "Deaths", "Biome", "Health_Remaining", "Hunger_Level", "Experience_Level", "Tools_Used", "Armor_Equipped", "Weather", "Game_Mode", "Day_Cycle", "Chat_Messages") %>% 
    datatable(options = list(pageLength = 10))
  })
  
  # Render Summary Statistics
  output$bar_graph <- renderPlot({
    ggplot(minecraft, aes_string(x = input$x_var, fill = input$y_var)) +
      geom_bar() +
      theme_minimal() +
      labs(title = paste("Bar Graph of", input$x_var, "Filled by", input$y_var))

  })
  
  # Render Scatter Plot
  output$scatter_plot <- renderPlot({
    ggplot(minecraft, aes_string(x = input$x_var, y = input$y_var)) +
      geom_point() +
      geom_smooth(method = lm, se = TRUE) +
      labs(title = paste("Scatter Plot of", input$x_var, "vs", input$y_var)) +
      theme_minimal()
  })
  
  # Render 3D Plot using plotly
  output$three_D_plot <- renderPlotly({
    # Filter the data based on selected Game Mode
    filtered_data <- minecraft %>% filter(Game_Mode == input$x)
    
    # Create the 3D scatter plot
    plot_ly(filtered_data, 
            x = ~Coordinates_X, 
            y = ~Coordinates_Z, 
            z = ~Coordinates_Y, 
            type = "scatter3d", 
            mode = "markers", 
            marker = list(size = 3, color = 'skyblue'))  # Added closing parenthesis here
  })
}

# Run the app
shinyApp(ui, server)
```

